# RDKit-Custom-Sanitization
This program addresses the issues of incorrect covalent bond recognition that can occur when RDKit and MDAnalysis convert molecules into their native software representations.

MDAnalysis does not have built-in functions for sanitizing molecules, checking valences, or removing small fragmetns, as RDKit does.Therefore, these erroneous covalent bonds remain in the MDAnalysis universe unless explicitly handled. RDKit, while capable of identifying atoms with incorrect valences, lacks a sophisticated mechanism for managing such instances. This can lead to crash during the conversion of a pdb file to an RDKit molecule.

This function establishes a custom method for managing incorrect valences between and within protein residues. It uses `amino_acid_connectivity.json`, a dictionary containing the "ground truth" covalent connectivity of all 20 amino acids and the protein backbone, to screen the local bonded neighborhood of an atom RDKit flags as having incorrect valence, and subsequently removes the incorrect connections from _BOTH_ the RDKit molecule and MD Universe. 

Current functionality alters the MDA and RDKit "bonded representations" of the protein only, not the underlying location of atoms in the pdb file that may be causing the sanitization failures. This program cannot resolve the misplacement of atoms, move atoms into more plausible locations, or reorient/rebuild side chains. If the valence error thrown is a result of erroneous bond degree, the function does not currently support the recharacterization of bonding degrees, although this can be added in a future update.
